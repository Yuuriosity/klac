#+begin_src agda2

module homework.Day2 where

open import Prelude
open import Day1
open import Day2

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 1 (â˜…)
Ğ’ÑĞ¿Ğ¾Ğ¼Ğ½Ğ¸Ñ‚Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ¾Ğ² Ğ¸ Ğ¿Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¾Ğ³Ğ¸Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:
  - Ğ‘Ğ¸Ğ½Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ´ĞµÑ€ĞµĞ²ÑŒÑ, Ñ…Ñ€Ğ°Ğ½ÑÑ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Ğ»Ğ¸ÑÑ‚ÑŒÑÑ….
  - Ğ‘Ğ¸Ğ½Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ´ĞµÑ€ĞµĞ²ÑŒÑ, Ñ…Ñ€Ğ°Ğ½ÑÑ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² ÑƒĞ·Ğ»Ğ°Ñ….
#+begin_src agda2

data Treeâ‚— (A : Typeâ‚€) : Typeâ‚€ where
  Leafâ‚— : A â†’ Treeâ‚— A
  Branchâ‚— : Treeâ‚— A â†’ Treeâ‚— A â†’ Treeâ‚— A

data Treeâ‚™ (A : Typeâ‚€) : Typeâ‚€ where
  Leafâ‚™ : Treeâ‚™ A
  Branchâ‚™ : A â†’ Treeâ‚™ A â†’ Treeâ‚™ A â†’ Treeâ‚™ A

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 2 (â˜…)
ĞĞ°Ğ¿Ğ¸Ğ¸ÑˆĞ¸Ñ‚Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ° (left to right) Ğ´Ğ»Ñ Ñ‚Ğ°ĞºĞ¸Ñ… Ğ´ĞµÑ€ĞµĞ²ÑŒĞµĞ², Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ
ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ´ĞµÑ€ĞµĞ²Ğ° Ğ² ÑĞ¿Ğ¸ÑĞ¾Ğº.
#+begin_src agda2

traverseâ‚— : {A : Typeâ‚€} â†’ Treeâ‚— A â†’ List A
traverseâ‚— (Leafâ‚— x) = x âˆ· []
traverseâ‚— (Branchâ‚— l r) = traverseâ‚— l ++ traverseâ‚— r

traverseâ‚™ : {A : Typeâ‚€} â†’ Treeâ‚™ A â†’ List A
traverseâ‚™ Leafâ‚™ = []
traverseâ‚™ (Branchâ‚™ x l r) = x âˆ· traverseâ‚™ l ++ traverseâ‚™ r

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3 (â˜…â˜…â˜…)
Ğ’ Haskell Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²ÑÑ‚Ñ€ĞµÑ‚Ğ¸Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ ~$~, Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑÑ‰ÑƒÑ Ğ½Ğµ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ»Ğ¸ÑˆĞ½Ğ¸Ğµ ÑĞºĞ¾Ğ±ĞºĞ¸,
Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑÑ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹ Ğ¾Ğ´Ğ½Ñƒ Ğ·Ğ° Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹. Ğ’ ÑĞ·Ñ‹ĞºĞµ Ñ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ğ¼Ğ¸ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ ĞµÑ‘
ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ° Ğ±Ğ¾Ğ»ĞµĞµ Ğ¾Ğ±Ñ‰Ğ°Ñ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ½Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¾Ğ±Ñ‰ÑƒÑ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ñƒ Ğ´Ğ»Ñ
Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹.
#+begin_src agda2

-- non-dependent
_$â‚•_ : {A B : Typeâ‚€} â†’ (A â†’ B) â†’ A â†’ B
f $â‚• x = f x

-- dependent
_$_ : {A : Typeâ‚€} {B : A â†’ Typeâ‚€} â†’ (f : (a : A) â†’ B a) â†’ (x : A) â†’ B x
f $ x = f x

-- non-dependent
_âˆ˜â‚•_ : {A B C : Typeâ‚€} â†’ (B â†’ C) â†’ (A â†’ B) â†’ (A â†’ C)
(g âˆ˜â‚• f) x = g (f x)

-- dependent
_âˆ˜_ : {A : Typeâ‚€} {B : A â†’ Typeâ‚€} {C : (a : A) â†’ B a â†’ Typeâ‚€}
    â†’ (g : {a : A} (b : B a) â†’ C a b) â†’ (f : (a : A) â†’ B a) â†’ (a : A) â†’ C a (f a)
(g âˆ˜ f) x = g (f x)

#+end_src
Ğ­Ñ‚Ñƒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Thierry Coquand Ğ´Ğ°Ğ²Ğ°Ğ» ĞºĞ¾Ğ¼Ñƒ-Ñ‚Ğ¾ Ğ½Ğ° Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ğ´Ğ¸Ğ¿Ğ»Ğ¾Ğ¼Ğ° :-)

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 4 (â˜…â˜…)
Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¼Ñ‹ Ğ·Ğ½Ğ°ĞµĞ¼, Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ´Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ¾Ğ²Ğ¸Ğ½ĞºÑƒ Ñ‚Ğ°Ğ²Ñ‚Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸ ~contra~ Ğ¸Ğ·
Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾Ğ³Ğ¾ Ğ´Ğ·. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ´Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞµÑ‘, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ğ·Ğ°ĞºĞ¾Ğ½ Ğ¸ÑĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ‚Ñ€ĞµÑ‚ÑŒĞµĞ³Ğ¾.

#+begin_src agda2

contraâ€² : {A B : ğ“¤â‚€} â†’ (lem : (Î  X ê‰ ğ“¤â‚€ , Dec X)) â†’ (Â¬ B â‡’ Â¬ A) â†’ (A â‡’ B)
contraâ€² {A} {B} lem nbna x with lem B
... | injâ‚ lb = lb
... | injâ‚‚ rb = ex-falso-quodlibet (nbna rb x)

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 5 (â˜…â˜…â˜…)
Ğ“Ğ¾Ñ‚Ñ‚Ñ„Ñ€Ğ¸Ğ´ Ğ›ĞµĞ¹Ğ±Ğ½Ğ¸Ñ† Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ» Ñ€Ğ°Ğ²ĞµĞ½ÑÑ‚Ğ²Ğ¾ Ñ‚Ğ°ĞºĞ¸Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ¼:
Ğ´Ğ»Ñ Ğ»ÑĞ±Ñ‹Ñ… ~x~ Ğ¸ ~y~, Ğ¾Ğ½Ğ¸ Ñ€Ğ°Ğ²Ğ½Ñ‹ Ñ‚Ğ¾Ğ³Ğ´Ğ° Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚Ğ¾Ğ³Ğ´Ğ°, ĞºĞ¾Ğ³Ğ´Ğ° Ğ´Ğ»Ñ Ğ»ÑĞ±Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ¸ĞºĞ°Ñ‚Ğ° ~P~,
~P(x)~ Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞºĞ²Ğ¸Ğ²Ğ°Ğ»ĞµĞ½Ñ‚Ğ½Ğ¾ ~P(y)~.

Ğ¡Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ğ¾ Ñ€Ğ°Ğ²ĞµĞ½ÑÑ‚Ğ²Ğ¾ Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾ Ğ¸Ğ· Ñ€Ğ°Ğ²ĞµĞ½ÑÑ‚Ğ²Ğ° Ğ¿Ğ¾ Ğ›ĞµĞ¹Ğ±Ğ½Ğ¸Ñ†Ñƒ ÑĞ»ĞµĞ´ÑƒĞµÑ‚ Ğ¸ Ğ½Ğ°ÑˆĞµ
Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ²ĞµĞ½ÑÑ‚Ğ²Ğ°, Ğ¸ Ğ½Ğ°Ğ¾Ğ±Ğ¾Ñ€Ğ¾Ñ‚.

#+begin_src agda2

_â‰¡â‚—_ : {A : Typeâ‚€} â†’ (x y : A) â†’ Typeâ‚
_â‰¡â‚—_ {A} x y = Î  P ê‰ (A â†’ Typeâ‚€) , (P x â†’ P y)

leibniz-to-martin-lÃ¶f : {A : Typeâ‚€} (x y : A) â†’ x â‰¡â‚— y â†’ x â‰¡ y
leibniz-to-martin-lÃ¶f x y eq = {!   !}

martin-lÃ¶f-to-leibniz : {A : Typeâ‚€} (x y : A) â†’ x â‰¡ y â†’ x â‰¡â‚— y
martin-lÃ¶f-to-leibniz x y eq = Î» p â†’ {!!}

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 6 (â˜…â˜…)
ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚Ğµ ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ñ‡Ñ‘Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ Ğ½ĞµÑ‡Ñ‘Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ»Ñ Ğ½Ğ°Ñ‚ÑƒÑ€Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ñ‡Ğ¸ÑĞµĞ». ĞŸĞ¾ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾
Ñ‡Ñ‘Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ğ¼Ğ° Ğ´Ğ»Ñ Ğ»ÑĞ±Ğ¾Ğ³Ğ¾ Ğ½Ğ°Ñ‚ÑƒÑ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ñ‡Ğ¸ÑĞ»Ğ°.

#+begin_src agda2

{-
Even : â„• â†’ Typeâ‚€
Even zero = âŠ¤
Even (suc zero) = âŠ¥
Even (suc (suc n)) = Even n

Odd : â„• â†’ Typeâ‚€
Odd zero = âŠ¥
Odd (suc zero) = âŠ¤
Odd (suc (suc n)) = Odd n
-}
mutual
  Even : â„• â†’ Typeâ‚€
  Even zero = âŠ¤
  Even (suc n) = Odd n

  Odd : â„• â†’ Typeâ‚€
  Odd zero = âŠ¥
  Odd (suc n) = Even n

even-dec : Î  n ê‰ â„• , Dec (Even n)
even-dec zero = injâ‚ tt
even-dec (suc zero) = injâ‚‚ id
even-dec (suc (suc n)) = even-dec n

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 7 (â˜…â˜…)
Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ñ‹ ÑĞ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰ÑƒÑ Ñ‚ĞµĞ¾Ñ€ĞµĞ¼Ñƒ:
#+begin_src agda2

lemma-suc : Î  m ê‰ â„• , (suc m > m)
lemma-suc zero = tt
lemma-suc (suc n) = lemma-suc n

lemma-evens> : Î  m ê‰ â„• , Î  n ê‰ â„• , (Even m âˆ§ Even n âˆ§ n > m â‡’ n > suc m)
lemma-evens> zero (suc (suc n)) (even-m , even-n , n>m) = n>m
lemma-evens> (suc (suc m))  (suc (suc n)) pf = lemma-evens> m n pf
-- lemma-evens> (suc (suc m)) zero (even-m , even-n , ())

hmm : Î  m ê‰ â„• , Î  n ê‰ â„• , (Even m âˆ§ Even n âˆ§ n > m â‡’ (Î£ k ê‰ â„• , k > m âˆ§ n > k âˆ§ Odd k))
hmm m n (even-m , even-n , n>m) = suc m , lemma-suc m , lemma-evens> m n (even-m , even-n , n>m)  , even-m

#+end_src
